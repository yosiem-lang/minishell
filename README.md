
# 🐚 Minishell: A Custom Shell Implementation

## 📋 プロジェクト概要

このプロジェクトは、**Unixシェル**（特にBash）の基本的な機能を再現するカスタムシェル「**Minishell**」をC言語で実装するものです。主要なビルトインコマンド、プロセス実行、パイプ、リダイレクション、環境変数管理、そしてシグナル処理などのコア機能が含まれています。

## 🚀 機能一覧 (Features)

Minishellは、以下の主要な機能をサポートしています。

### 1\. プロセス管理と実行

  * **コマンド実行**: 絶対パス (`/bin/ls`) および `$PATH`を通じたコマンド実行 (`ls`)。
  * **プロセス終了ステータス**: 最後の実行プロセスの終了コードを `$?` で取得。
  * **引数処理**: 複雑な引数と引用符の処理。

### 2\. リダイレクションとパイプ

  * **リダイレクション**:
      * 標準出力の上書き (`>`) および追記 (`>>`)
      * 標準入力のリダイレクト (`<`)
      * ヒアドキュメント (`<<`)
  * **パイプ**: 複数のコマンドを接続し、標準入出力を連携させる機能 (`cmd1 | cmd2 | cmd3`)。

### 3\. 環境変数と引用符

  * **環境変数展開**: ダブルクォート内 (`"Hello $USER"`) での変数展開をサポート。
  * **リテラル処理**: シングルクォート (`'...'`) 内の文字列は展開せず、リテラルとして扱う。

### 4\. ビルトインコマンド (Built-in Commands)

以下の標準的なビルトインコマンドを実装しています。

| コマンド | 機能 |
| :--- | :--- |
| **`echo`** | 文字列を出力。`-n` オプションをサポート。 |
| **`cd`** | カレントディレクトリを変更。相対パス、絶対パス、`..`, `.` をサポート。 |
| **`pwd`** | カレントディレクトリの絶対パスを出力。 |
| **`export`** | 環境変数を設定、変更、およびエクスポート。 |
| **`unset`** | 環境変数を削除。 |
| **`env`** | 環境変数を表示。 |
| **`exit`** | シェルを終了。引数による終了ステータス指定をサポート。 |

### 5\. シグナル処理

  * **Ctrl-C** (`SIGINT`): プロセスの中断と新しいプロンプトの表示。
  * \**Ctrl-\** (`SIGQUIT`): 実行中のコマンドを終了。（通常、プロンプトでは何もしない）
  * **Ctrl-D** (`EOF`): EOF（End of File）として解釈し、シェルを終了。

## 🧪 評価用テストケース (Evaluation Test Cases)

Minishellの動作を検証するための具体的なコマンド例です。

### 1\. シンプルコマンド & エラー処理

| テスト目的 | コマンド例 | 期待される動作 |
| :--- | :--- | :--- |
| **絶対パス実行** | `/bin/ls` | 実行される |
| **単純なコマンド** | `ls -l` | 実行される |
| **空のコマンド** | (Enterのみ) | プロンプト再表示 |
| **無効なコマンド** | `this_command_does_not_exist` | エラーメッセージ表示（クラッシュ禁止） |
| **終了ステータス** | `ls file_exists` & `echo $?` | `0` が表示される |
| **終了ステータス** | `ls file_not_exists` & `echo $?` | `1` または `2` が表示される |

### 2\. 引用符と環境変数

| テスト目的 | コマンド例 | 期待される出力 |
| :--- | :--- | :--- |
| **シングルクォート** | `echo '$USER'` | `$USER` (リテラル) |
| **ダブルクォート** | `echo "$USER"` | `$USER` の値 |
| **ダブルクォート内のリテラル** | `echo "pipe \| not pipe"` | `pipe | not pipe` |
| **変数展開** | `echo Hello $USER` | `Hello [ユーザー名]` |
| **空の変数** | `echo "$NON_EXISTING_VAR"` | (空行) |

### 3\. ビルトインコマンドの動作

| テスト目的 | コマンド例 | 期待される動作 |
| :--- | :--- | :--- |
| **`echo` の `-n`** | `echo -n hello world` | `hello world` (改行なし) |
| **`cd` の移動** | `cd ..` & `pwd` | 1つ上のディレクトリが表示される |
| **`export` 新規** | `export MY_VAR=42` & `env` | `MY_VAR=42` が表示される |
| **`unset` 削除** | `unset MY_VAR` & `env` | `MY_VAR` がリストから消える |
| **`exit` ステータス** | `exit 127` | シェルが終了し、`bash`で`echo $?`が`127` |
| **`exit` エラー** | `exit too many args` | エラー表示後、終了しない |

### 4\. リダイレクションとパイプ

| テスト目的 | コマンド例 | 期待される動作 |
| :--- | :--- | :--- |
| **リダイレクト** | `echo "test" > out.txt` | `out.txt`に`test`が書き込まれる |
| **追記** | `echo "append" >> out.txt` | `out.txt`の末尾に追記される |
| **入力** | `cat < out.txt` | `out.txt`の内容が出力される |
| **ヒアドキュメント** | `grep test << EOF` | EOFまで入力待ちとなり、入力が`grep`に渡される |
| **パイプ** | `ls -l | grep minish | wc -l` | 正しく実行され、最終結果が出力される |
| **パイプとリダイレクト** | `ls -l | grep minish > pipe_out.txt` | 結果がファイルに書き込まれる |

### 5\. シグナル処理のテスト

| テスト目的 | シグナル操作 | 状況 | 期待される動作 |
| :--- | :--- | :--- | :--- |
| **Ctrl-C (SIGINT)** | **Ctrl-C** | プロンプトが空の状態 | 新しい行にプロンプト再表示 |
| **Ctrl-C (実行中)** | **Ctrl-C** | `cat` 実行中 | `cat` が中断され、プロンプト再表示 |
| **Ctrl-\\ (SIGQUIT)** | \**Ctrl-\** | プロンプトが空の状態 | 何もしない |
| **Ctrl-\\ (実行中)** | \**Ctrl-\** | `cat` 実行中 | `Quit: 3` などが表示され、プロンプト再表示 |
| **Ctrl-D (EOF)** | **Ctrl-D** | プロンプトが空の状態 | シェルが終了する |

## 🛠️ ビルドと実行方法

1.  **リポジトリのクローン**

    ```bash
    git clone [リポジトリURL]
    cd minishell
    ```

2.  **コンパイル**

    ```bash
    make
    ```

      * コンパイルには `-Wall -Wextra -Werror` フラグが適用されています。

3.  **実行**

    ```bash
    ./minishell
    ```

    シェルが起動し、プロンプトが表示されます。

    ```
    minishell>
    ```



# 📝 Minishell 実行テストケースコマンド集

以下のコマンドは、Minishellの各機能を検証するために、**Minishellのプロンプト**で実行することを想定しています。

## 1. 🛠️ コンパイルと基本動作

| テスト目的 | コマンド（Shellで実行） |
| :--- | :--- |
| ビルドフラグ確認 | `make -n` |
| コンパイルとエラー確認 | `make` |
| 再リンクの禁止確認 | `make` を連続で2回実行 |
| **起動** | `./minishell` (Minishellプロンプトへ) |

---

## 2. 🚀 シンプルコマンドと引数

| テスト目的 | コマンド（Minishellで実行） |
| :--- | :--- |
| 絶対パス実行 | `/bin/ls` |
| 空のコマンド | （Enterキーのみ） |
| スペース・タブのみ | `     ` |
| 絶対パスと引数 | `/bin/echo hello world` |
| 引数とオプション | `ls -l` |
| 複数コマンドと引数 | `grep minish main.c Makefile` |

---

## 3. 💰 プロセス終了ステータス

| テスト目的 | コマンド（Minishellで実行） |
| :--- | :--- |
| 成功後のステータス | `/bin/ls` |
| 成功後のステータス確認 | `echo $?` |
| 失敗後のステータス | `/bin/ls filethatdoesntexist` |
| 失敗後のステータス確認 | `echo $?` |
| 算術演算 (任意) | `expr $? + $?` |

---

## 4. 🔗 引用符と環境変数

| テスト目的 | コマンド（Minishellで実行） |
| :--- | :--- |
| ダブルクォートとスペース | `echo "hello world"` |
| ダブルクォート内リテラル | `echo "cat lol.c | cat > lol.c"` |
| シングルクォート内のリテラル | `echo '$USER'` |
| シングルクォート内の空引数 | `echo ''` |
| 環境変数展開 (非引用符) | `echo $USER` |
| 環境変数展開 (ダブルクォート) | `echo "$USER"` |

---

## 5. 🐚 ビルトインコマンド

| テスト目的 | コマンド（Minishellで実行） |
| :--- | :--- |
| `echo` 基本 | `echo hello` |
| `echo` -n オプション | `echo -n hello` |
| `exit` 基本 | `exit` |
| `exit` 引数あり | `exit 42` |
| `env` | `env` |
| `export` 新規 | `export TEST_VAR=42` |
| `export` 確認 | `env` |
| `unset` 削除 | `unset TEST_VAR` |
| `unset` 確認 | `env` |
| `cd` 親ディレクトリ | `cd ..` |
| `cd` カレントディレクトリ | `cd .` |
| `cd` 失敗ケース | `cd /non/existent/path` |
| `pwd` | `pwd` |

---

## 6. ⚙️ パスとリダイレクション

| テスト目的 | コマンド（Minishellで実行） |
| :--- | :--- |
| 相対パス実行 | `./a.out` (実行ファイルがある場合) |
| 複雑な相対パス | `cd /usr/bin; ../../bin/ls` |
| $PATH経由の実行 | `ls` |
| $PATH unset | `unset PATH` |
| $PATH unset後の実行 | `ls` |
| $PATH multi-set | `export PATH=/bin:/usr/bin` |
| 標準出力リダイレクト | `echo test > out.txt` |
| 標準入力リダイレクト | `cat < out.txt` |
| 追記リダイレクト | `echo append >> out.txt` |
| 複数リダイレクト | `cat < out.txt > final.txt` |
| ヒアドキュメント | `grep test << END` |
| リダイレクト失敗ケース | `cat < /dev/null > /etc/shadow` (書き込み権限エラーを誘発) |

---

## 7. 🔀 パイプ

| テスト目的 | コマンド（Minishellで実行） |
| :--- | :--- |
| 単純なパイプ | `cat /etc/hosts | grep local` |
| 複数パイプ | `cat file | grep bla | more` |
| 失敗コマンドを含むパイプ | `ls filethatdoesntexist | grep bla | more` |
| パイプとリダイレクト | `ls -l | grep minish > pipe_out.txt` |
| 変則的なパイプ | `cat | cat | ls` |

---

## 8. 🛑 シグナルと歴史機能

以下のテストは、特定のキー操作を要求します。

| テスト目的 | コマンド（Minishellで実行） |
| :--- | :--- |
| **Ctrl-C** (空のプロンプト) | (何も入力せず) **Ctrl-C** |
| **Ctrl-\** (空のプロンプト) | (何も入力せず) **Ctrl-\** |
| **Ctrl-D** (空のプロンプト) | (何も入力せず) **Ctrl-D** |
| **Ctrl-C** (入力途中) | `echo hello` と入力し **Ctrl-C** |
| **Ctrl-C** (実行中) | `cat` を実行中に **Ctrl-C** |
| **Ctrl-\** (実行中) | `cat` を実行中に **Ctrl-\** |
| **ヒストリ確認** | `ls`, `pwd` などを実行後、**上矢印** / **下矢印** |
| **バッファクリア確認** | `echo test` と入力後、**Ctrl-C**、その後 **Enter** |
| **クラッシュ回避** | `dsbksdgbksdghsd` |
    
